<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Solvoro â€” Edit Profile</title>
<link rel="icon" href="favicon.png" type="image/png">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root{
  --bg-main:#071024;
  --bg-card:#0b1220;
  --text-light:#e6eef6;
  --text-muted:#94a3b8;
  --accent-start:#7c3aed;
  --accent-end:#06b6d4;
  --border-light:rgba(255,255,255,0.05);
  --radius:12px;
  --max-width:1100px;
}

*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Inter',sans-serif;background:var(--bg-main);color:var(--text-light);line-height:1.6;min-height:100vh;}

a{text-decoration:none;color:inherit;}
.container{max-width:var(--max-width);margin:0 auto;padding:20px;}

/* Header */
header{
  position:sticky;top:0;z-index:60;
  background:rgba(7,16,36,0.95);
  border-bottom:1px solid var(--border-light);
  backdrop-filter: blur(6px);
}
.nav{
  display:flex;align-items:center;justify-content:space-between;gap:20px;
  max-width:var(--max-width);margin:0 auto;padding:12px 20px;position:relative;
}
.brand{display:flex;align-items:center;gap:12px}
.logo{width:48px;height:48px;border-radius:50%;overflow:hidden;display:grid;place-items:center}
.logo img{width:100%;height:100%;object-fit:cover;display:block}
.brand-text{font-weight:700;font-size:18px;color:var(--text-light)}
nav ul{display:flex;gap:20px;list-style:none;align-items:center;margin:0;}
nav ul li{font-weight:600;color:var(--text-muted);}
nav ul li a{padding:6px 8px;border-radius:8px;display:inline-block;color:var(--text-light);}
nav ul li a:hover{color:var(--text-light);background:transparent;}

/* Profile Form */
.profile-card{
  background:var(--bg-card);
  padding:30px;
  border-radius:var(--radius);
  margin-top:40px;
  border:1px solid var(--border-light);
  box-shadow:0 8px 20px rgba(0,0,0,0.5);
  max-width:600px;
}
.profile-card h2{text-align:center;color:var(--accent-start);margin-bottom:20px;}
.profile-card label{display:block;margin-top:12px;font-weight:500;}
.profile-card input, .profile-card textarea{
  width:100%;padding:10px;margin-top:6px;border-radius:8px;border:1px solid rgba(255,255,255,0.2);
  background:var(--bg-main);color:var(--text-light);
}
.profile-card button{
  margin-top:20px;padding:12px;width:100%;border:none;border-radius:12px;font-weight:700;
  background:linear-gradient(90deg,var(--accent-start),var(--accent-end));
  color:#fff;cursor:pointer;transition:0.3s;
}
.profile-card button:hover{filter:brightness(1.05);}
@media (max-width:480px){.profile-card{padding:20px;}}
</style>
</head>
<body>
<header>
  <div class="nav container">
    <div class="brand">
      <div class="logo"><img src="favicon.png" alt="Solvoro logo"></div>
      <div class="brand-text">Solvoro</div>
    </div>
    <nav>
      <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="dashboard.html" id="userLink">Dashboard</a></li>
        <li><a href="login.html" id="loginLink">Login</a></li>
      </ul>
    </nav>
  </div>
</header>

<main class="container">
  <div class="profile-card">
    <h2>Edit Profile</h2>
    <form id="profileForm">
      <label for="fullName">Full Name</label>
      <input type="text" id="fullName" required>
      <label for="email">Email</label>
      <input type="email" id="email" required disabled>
      <label for="phone">Phone</label>
      <input type="text" id="phone">
      <label for="dob">Date of Birth</label>
      <input type="date" id="dob">
      <label for="city">City</label>
      <input type="text" id="city">
      <label for="country">Country</label>
      <input type="text" id="country">
      <label for="notes">Notes</label>
      <textarea id="notes" rows="3"></textarea>
      <button type="submit">Save Changes</button>
    </form>
  </div>
</main>

<script>
const user = JSON.parse(localStorage.getItem('solvoroUser'));
const userLink=document.getElementById('userLink');
const loginLink=document.getElementById('loginLink');
if(!user || !user._id){ alert('Please login first!'); window.location.href='login.html'; }
else{ userLink.textContent=user.fullName; loginLink.style.display='none'; }

// Fill form
document.getElementById('fullName').value=user.fullName||'';
document.getElementById('email').value=user.email||'';
document.getElementById('phone').value=user.phone||'';
document.getElementById('dob').value=user.dob||'';
document.getElementById('city').value=user.city||'';
document.getElementById('country').value=user.country||'';
document.getElementById('notes').value=user.notes||'';

// Save changes
document.getElementById('profileForm').addEventListener('submit', async e=>{
  e.preventDefault();
  const updated={
    name: document.getElementById('fullName').value.trim(),
    phone: document.getElementById('phone').value.trim(),
    dob: document.getElementById('dob').value,
    city: document.getElementById('city').value.trim(),
    country: document.getElementById('country').value.trim(),
    notes: document.getElementById('notes').value.trim()
  };
  try{
    const res=await fetch(`http://localhost:5000/update-profile/${user._id}`,{
      method:'PUT',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify(updated)
    });
    const data=await res.json();
    if(res.ok){
      localStorage.setItem('solvoroUser', JSON.stringify(data.user));
      alert('Profile updated successfully!');
    } else {alert(data.message||'Update failed!');}
  }catch(err){console.error(err);alert('Server error!');}
});
</script>
</body>
</html>
