<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Solvoro â€” Dashboard</title>
  <link rel="icon" href="favicon.png" type="image/png">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-main: #071024;
      --bg-card: #0b1220;
      --text-light: #e6eef6;
      --text-muted: #94a3b8;
      --accent-start: #7c3aed;
      --accent-end: #06b6d4;
      --border-light: rgba(255,255,255,0.05);
      --radius: 12px;
      --max-width: 1100px;
    }

    * {box-sizing: border-box; margin: 0; padding: 0;}
    body {font-family: 'Inter', sans-serif; background: var(--bg-main); color: var(--text-light); min-height: 100vh;}
    a {color: inherit; text-decoration: none;}
    .container {max-width: var(--max-width); margin: 0 auto; padding: 20px;}

    /* Header */
    header {position: sticky; top:0; z-index:60; background: rgba(7,16,36,0.95); border-bottom:1px solid var(--border-light); backdrop-filter: blur(6px);}
    .nav {display:flex; justify-content: space-between; align-items: center; gap:20px; max-width: var(--max-width); margin:0 auto; padding:12px 20px;}
    .brand {display:flex; align-items:center; gap:12px;}
    .logo {width:48px; height:48px; border-radius:50%; overflow:hidden; display:grid; place-items:center;}
    .logo img {width:100%; height:100%; object-fit:cover;}
    .brand-text {font-weight:700; font-size:18px; color: var(--text-light);}
    nav ul {display:flex; gap:20px; list-style:none; align-items:center;}
    nav ul li {font-weight:600; color: var(--text-muted);}
    nav ul li a {padding:6px 8px; border-radius:8px; display:inline-block; color: var(--text-light);}
    nav ul li a:hover {background: transparent; color: var(--accent-end);}

    /* Dashboard */
    h2 {margin-bottom:20px;}
    .dashboard {display:flex; flex-direction: column; gap:20px;}
    .profile-header {display:flex; flex-wrap:wrap; gap:20px; align-items:center;}
    .profile-pic {width:120px; height:120px; border-radius:50%; overflow:hidden; border:2px solid var(--accent-start);}
    .profile-pic img {width:100%; height:100%; object-fit:cover;}
    .profile-info {flex:1; display:flex; flex-direction: column; gap:6px;}
    .profile-info h3 {color: var(--accent-start);}
    .profile-info p {color: var(--text-muted);}
    .edit-btn {padding:10px 16px; border:none; border-radius:12px; background: var(--accent-end); color:#fff; cursor:pointer; font-weight:700; align-self:flex-start; margin-top:10px;}
    .info-card {background: var(--bg-card); padding:16px; border-radius: var(--radius); border:1px solid var(--border-light);}
    .info-card h3 {color: var(--accent-start); margin-bottom:6px;}
    .info-card p {color: var(--text-muted);}
    .footer {margin-top:40px; padding:20px; text-align:center; border-top:1px solid var(--border-light); color:var(--text-muted);}
    input, textarea {width:100%; padding:8px 12px; border-radius:8px; border:1px solid rgba(255,255,255,0.2); background: var(--bg-main); color: var(--text-light);}
    button.save-btn {padding:10px 16px; border:none; border-radius:12px; background: var(--accent-start); color:#fff; cursor:pointer; font-weight:700;}
    @media(max-width:768px){
      .profile-header {flex-direction: column; align-items:flex-start;}
      .profile-pic {width:100px; height:100px;}
    }
  </style>
</head>
<body>

<!-- Header -->
<header>
  <div class="nav container">
    <div class="brand">
      <div class="logo"><img src="favicon.png" alt="Solvoro Logo"></div>
      <div class="brand-text">Solvoro</div>
    </div>
    <nav>
      <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="about.html">About</a></li>
        <li><a href="services.html">Services</a></li>
        <li><a href="dashboard.html" id="userLink">Dashboard</a></li>
      </ul>
    </nav>
  </div>
</header>

<!-- Dashboard -->
<main class="container">
  <h2>Your Profile</h2>
  <div class="dashboard" id="dashboardContent">
    <!-- Profile info will load here -->
  </div>
</main>

<!-- Footer -->
<div class="footer">
  &copy; 2025 Solvoro. All rights reserved.
</div>

<script>
  const user = JSON.parse(localStorage.getItem('solvoroUser'));
  const dashboard = document.getElementById('dashboardContent');
  const userLink = document.getElementById('userLink');

  if(!user){
    alert('Please login first!');
    window.location.href = 'login.html';
  } else {
    userLink.textContent = user.name;
    userLink.href = 'dashboard.html';

    function renderDashboard(editMode=false){
      dashboard.innerHTML = `
        <div class="profile-header">
          <div class="profile-pic">
            <img src="${user.profilePic || 'favicon.png'}" alt="Profile Pic">
          </div>
          <div class="profile-info">
            ${editMode ? `
              <input type="text" id="name" value="${user.name}">
              <input type="email" id="email" value="${user.email}" disabled>
              <input type="text" id="phone" value="${user.phone || ''}">
              <input type="text" id="city" value="${user.city || ''}" placeholder="City">
              <input type="text" id="country" value="${user.country || ''}" placeholder="Country">
              <input type="text" id="skills" value="${user.skills ? user.skills.join(', ') : ''}" placeholder="Skills (comma separated)">
              <textarea id="about" placeholder="About">${user.about || ''}</textarea>
              <textarea id="address" placeholder="Address">${user.address || ''}</textarea>
              <button class="save-btn" id="saveBtn">Save Changes</button>
            ` : `
              <h3>${user.name}</h3>
              <p>Email: ${user.email}</p>
              <p>Phone: ${user.phone || 'Not provided'}</p>
              <p>City: ${user.city || 'Not provided'}</p>
              <p>Country: ${user.country || 'Not provided'}</p>
              <p>Skills: ${user.skills ? user.skills.join(', ') : 'Not provided'}</p>
              <p>About: ${user.about || 'Not provided'}</p>
              <p>Address: ${user.address || 'Not provided'}</p>
              <button class="edit-btn" id="editBtn">Edit Profile</button>
            `}
          </div>
        </div>
      `;

      if(editMode){
        document.getElementById('saveBtn').addEventListener('click', async ()=>{
          const updatedUser = {
            email: user.email,
            name: document.getElementById('name').value,
            phone: document.getElementById('phone').value,
            city: document.getElementById('city').value,
            country: document.getElementById('country').value,
            skills: document.getElementById('skills').value.split(',').map(s=>s.trim()),
            about: document.getElementById('about').value,
            address: document.getElementById('address').value
          };

          const res = await fetch('https://solvoro-web-backend.onrender.com/update-profile',{
            method:'POST',
            headers:{'Content-Type':'application/json'},
            body: JSON.stringify(updatedUser)
          });
          const data = await res.json();
          if(res.ok){
            alert('Profile updated!');
            localStorage.setItem('solvoroUser', JSON.stringify(data.user));
            renderDashboard(false);
          } else {
            alert(data.message || 'Update failed');
          }
        });
      } else {
        document.getElementById('editBtn').addEventListener('click', ()=> renderDashboard(true));
      }
    }

    renderDashboard();
  }
</script>

</body>
</html>
